% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/construct_multi_layered_network.R,
%   R/construct_multi_layered_network_full.R
\name{con_mln}
\alias{con_mln}
\title{Multi-layered network construction}
\usage{
con_mln(
  gene_abun_file,
  path_abun_file,
  path_con_file,
  met_con_file,
  metadata_file,
  taxonomy_file = NULL,
  map_file,
  output_dir,
  format = c("universal", "humann", "picrust"),
  ppn_da_method = c("deseq2", "edger", "maaslin2", "simple"),
  ppn_map_database = c("kegg", "metacyc", "custom"),
  ppn_rank_by = c("signed_log_pvalue", "log2foldchange", "pvalue"),
  ppn_p_adjust_method = c("fdr", "holm", "hochberg", "hommel", "bonferroni", "BH", "BY",
    "none"),
  ppn_pvalue_cutoff = 0.05,
  ppn_jaccard_cutoff = 0.2,
  comparisons_list = NULL,
  mpn_filtering = c("unfiltered", "mean", "median", "top10\%", "top25\%", "top50\%",
    "top75\%"),
  pmn_corr_method = c("spearman", "pearson", "kendall"),
  pmn_filter_by = c("none", "p_value", "q_value"),
  pmn_corr_cutoff = 0.3,
  pmn_pvalue_cutoff = 0.05,
  pmn_q_value_cutoff = 0.05,
  pmn_p_adjust_method = "fdr"
)

con_mln(
  gene_abun_file,
  path_abun_file,
  path_con_file,
  met_con_file,
  metadata_file,
  taxonomy_file = NULL,
  map_file,
  output_dir,
  format = c("universal", "humann", "picrust"),
  ppn_da_method = c("deseq2", "edger", "maaslin2", "simple"),
  ppn_map_database = c("kegg", "metacyc", "custom"),
  ppn_rank_by = c("signed_log_pvalue", "log2foldchange", "pvalue"),
  ppn_p_adjust_method = c("fdr", "holm", "hochberg", "hommel", "bonferroni", "BH", "BY",
    "none"),
  ppn_pvalue_cutoff = 0.05,
  ppn_jaccard_cutoff = 0.2,
  comparisons_list = NULL,
  mpn_filtering = c("unfiltered", "mean", "median", "top10\%", "top25\%", "top50\%",
    "top75\%"),
  pmn_corr_method = c("spearman", "pearson", "kendall"),
  pmn_filter_by = c("none", "p_value", "q_value"),
  pmn_corr_cutoff = 0.3,
  pmn_pvalue_cutoff = 0.05,
  pmn_q_value_cutoff = 0.05,
  pmn_p_adjust_method = "fdr"
)
}
\arguments{
\item{gene_abun_file}{Character path to gene abundance file.}

\item{path_abun_file}{Character path to pathway abundance file.}

\item{path_con_file}{Character path to pathway contribution file.}

\item{met_con_file}{Character path to metabolite concentration file.}

\item{metadata_file}{Character path to metadata file (Must contain 'SampleID' and 'class').}

\item{taxonomy_file}{Character path to taxonomy file (Required for 'picrust').}

\item{map_file}{Character path to pathway-to-gene mapping file.}

\item{output_dir}{Character path to output directory.}

\item{format}{Input format options: "universal", "humann", "picrust".}

\item{ppn_da_method}{DA method options: "deseq2", "edger", "maaslin2", "simple".}

\item{ppn_map_database}{Database options: "kegg", "metacyc", "custom".}

\item{ppn_rank_by}{GSEA ranking options: "signed_log_pvalue", "log2foldchange", "pvalue".}

\item{ppn_p_adjust_method}{GSEA p-adj options: "fdr", "holm", "hochberg", "hommel", "bonferroni", "BH", "BY", "none".}

\item{ppn_pvalue_cutoff}{Numeric p-value cutoff for GSEA.}

\item{ppn_jaccard_cutoff}{Numeric Jaccard cutoff for PPN edges.}

\item{comparisons_list}{List of character vectors (e.g., list(c("Healthy", "Stage_III_IV"))). First element is Reference.}

\item{mpn_filtering}{MPN filtering options: "unfiltered", "mean", "median", "top10%", "top25%", "top50%", "top75%".}

\item{pmn_corr_method}{Correlation options: "spearman", "pearson", "kendall".}

\item{pmn_filter_by}{Filter options: "none", "p_value", "q_value".}

\item{pmn_corr_cutoff}{Numeric correlation cutoff.}

\item{pmn_pvalue_cutoff}{Numeric p-value cutoff.}

\item{pmn_q_value_cutoff}{Numeric q-value cutoff.}

\item{pmn_p_adjust_method}{PMN q-value adj options: "fdr", "holm", "hochberg", "hommel", "bonferroni", "BH", "BY", "none".}

\item{gsea_results_file}{A character string specifying the path to the
GSEA results file (from `construct_pathway_pathway_network`).
This file is crucial for defining the set of pathways to be included
in the multi-layered network. Must contain an 'ID' column for pathways.}

\item{microbe_pathway_file}{A character string specifying the path to the
Microbe-Pathway network file (from `construct_microbe_pathway_network`).
Expected columns: 'TaxonID', 'FunctionID', 'relative_contribution'.
If the file is not found or invalid, this layer will be skipped.}

\item{pathway_jaccard_file}{A character string specifying the path to the
Pathway-Pathway Jaccard index file (from `construct_pathway_pathway_network`).
Expected columns: 'FunctionID_1', 'FunctionID_2', 'jaccard_index'.
If the file is not found or invalid, this layer will be skipped.}

\item{pathway_metabolite_file}{A character string specifying the path to the
Pathway-Metabolite network file (from `construct_pathway_metabolite_network`).
Expected columns: 'FunctionID', 'MetaboliteID', 'correlation'.
If the file is not found or invalid, this layer will be skipped.}

\item{output_directory}{A character string specifying the path to the directory
where the final integrated multi-layered network CSV file will be saved.
The directory will be created if it does not exist.}

\item{file_type}{A character string indicating the type of input files.
Must be "csv" (for comma-separated) or "tsv" (for tab-separated).}
}
\value{
The function's primary output is a single CSV file saved to the specified \code{output_directory}, containing the combined and filtered edges from all integrated network layers.

Vector of final network file paths.
}
\description{
This function integrates various network layers (Microbe-Pathway, Pathway-Pathway,
and Pathway-Metabolite) into a single comprehensive network. It uses GSEA
results as a central filter to ensure that only relevant pathways and their
associated connections are included in the final integrated network.

Standardizes input (Universal, HUMAnN, PICRUSt), builds PPN, MPN, and PMN layers,
and integrates them into a final visualized network.
}
\details{
The function performs the following steps:
1. Creates an output directory for the combined network file.
2. Parses the GSEA results filename to identify a target group, which can
   influence the naming of the output file.
3. Loads the GSEA results file to identify a definitive set of pathways
   to be integrated across all layers.
4. Iteratively loads and processes each network layer (Microbe-Pathway,
   Pathway-Pathway, Pathway-Metabolite), filtering edges to include only
   connections involving the identified GSEA pathways.
5. Standardizes the column names for each layer's edges (Feature1, Feature2,
   edge_score, edge_type).
6. Combines all collected and filtered network edges into a single data frame.
7. Saves the final integrated multi-layered network to a CSV file in the
   specified output directory, with a filename dynamically generated based
   on the GSEA target group or a default 'overall' suffix.
}
